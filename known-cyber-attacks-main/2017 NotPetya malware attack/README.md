# **2017 NotPetya malware attack**

## The main attacked subject and time
Two years after the Ukraine power grid attack, Sandworm struck again, this time with a malware attack that, while almost certainly focused on Ukraine, inflicted enormous collateral damage across the globe. ESET estimated on **28 June 2017** that **80% of all infections were in Ukraine**, with **Germany** second hardest hit with about **9%**. 
Interestingly, although NotPetya gave the impression of being a ransomware attack, clues quickly began to suggest that the motives of its creators were more political than financial and that Ukraine was their main target. One such clue was the software used to initiate the infection was the **Ukrainian tax software, M.E.Doc,** which is used throughout the country. As a result, 80% of NotPetya infections were estimated to have occurred in Ukraine.

## Negative impact
NotPetya proved to be a more significant and virulent threat. Like the WannaCry ransomware that also caused global havoc in 2017, it utilised a Windows Server Message Block (SMB) exploit to spread more rapidly.It’s estimated that organisations collectively lost $1 billion as a result of the attack.

## STRIDE model
Tampering
Spoofing

## Vulnerability
MeDoc provides periodic updates to its program through an update server. On the day of the attack, 27 June 2017, an update for MeDoc was pushed out by the update server, following which the ransomware attack began to appear. British malware expert Marcus Hutchins claimed **"It looks like the software's automatic update system was compromised and used to download and run malware rather than updates for the software."** Following the initial 27 June attack, security experts found that the code that had infected the M.E.Doc update had a **backdoor** that could potentially be used to launch another cyberattack.

## The attack agent
Wired technology writer Andy Greenberg, in reviewing the history of the cyberattacks, said that the attacks came from a **Russian military hacker group** called "**Sandworm**".

## Exploit
The cyberattack was based on a modified version of the Petya ransomware. Like the WannaCry ransomware attack in May 2017, Petya uses the **EternalBlue exploit** previously discovered in older versions of the Microsoft Windows operating system. When Petya is executed, it encrypts the Master File Table of the hard drive and forces the computer to restart. 

## Measure as to against the attack
The campaign was followed by an extensive public attribution to Russia, which denied all allegations. No further publicly known measures were taken by the victims against Russia.

## CVE number
Petya exploits the vulnerability **CVE-2017-0144** in Microsoft’s implementation of the Server Message Block protocol. 

## Research [1]
How the ransomware attack the system and how to recover from it—decrypting the MFT, interrupting the encryption process, using some anti-spyware and formatting the infected hard drive and restoring the ﬁles from backups.


*Reference:
https://en.wikipedia.org/wiki/2017_Ukraine_ransomware_attacks <br />
https://www.historyhit.com/the-biggest-cyberattacks-in-history/ <br />
https://cyberlaw.ccdcoe.org/wiki/NotPetya_(2017) <br />
[1]https://www.researchgate.net/publication/324489505_What_PetyaNotPetya_Ransomware_Is_and_What_Its_Remidiations_Are
*
